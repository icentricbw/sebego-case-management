{# templates/admin/client/matters.html.twig #}

{% if field.value is empty %}
    <div class="alert alert-info">
        <i class="fas fa-info-circle"></i> No matters associated with this client.
    </div>
{% else %}
    <div class="mb-2">
        <strong>Total Matters:</strong> {{ field.value|length }}
    </div>

    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead>
            <tr>
                <th>File Number</th>
                <th>Case Type</th>
                <th>Client Role</th>
                <th>Status</th>
                <th>Filing Date</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody>
            {% for matterClient in field.value %}
                {% set matter = matterClient.matter %}
                <tr>
                    <td>
                        <strong>{{ matter.fileNumber }}</strong>
                    </td>
                    <td>
                        {{ matter.caseType ? matter.caseType.name : 'N/A' }}
                    </td>
                    <td>
                            <span class="badge bg-primary">
                                {{ matterClient.clientRole ? matterClient.clientRole.value : 'N/A' }}
                            </span>
                    </td>
                    <td>
                        {% if matter.statusType %}
                            <span class="badge bg-{{ matter.statusType.value == 'ACTIVE' ? 'success' : (matter.statusType.value == 'CLOSED' ? 'secondary' : 'warning') }}">
                                    {{ matter.statusType.value }}
                                </span>
                        {% endif %}
                    </td>
                    <td>
                        {{ matter.filingDate ? matter.filingDate|date('M d, Y') : 'N/A' }}
                    </td>
                    <td>
                        <a href="{{ ea_url()
                            .setController('App\\Controller\\Admin\\MatterCrudController')
                            .setAction('detail')
                            .setEntityId(matter.id) }}"
                           class="btn btn-sm btn-primary">
                            <i class="fas fa-eye"></i> View
                        </a>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
{% endif %}
