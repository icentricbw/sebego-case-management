{# templates/admin/matter/clients.html.twig #}

{% if field.value is empty %}
    <div class="alert alert-info">
        <i class="fas fa-info-circle"></i> No clients linked to this matter.
    </div>
{% else %}
    <div class="mb-2">
        <strong>Total Clients:</strong> {{ field.value|length }}
    </div>

    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead>
            <tr>
                <th>Client</th>
                <th>Type</th>
                <th>Role in Matter</th>
                <th>Contact</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody>
            {% for matterClient in field.value %}
                {% set client = matterClient.client %}
                <tr>
                    <td>
                        <strong>
                            {% if client.clientType.value == 'INDIVIDUAL' %}
                                <i class="fas fa-user text-primary me-1"></i>
                                {{ client.fullName }}
                            {% else %}
                                <i class="fas fa-building text-info me-1"></i>
                                {{ client.companyName }}
                            {% endif %}
                        </strong>
                        {% if client.clientType.value == 'INDIVIDUAL' and client.identificationNumber %}
                            <br>
                            <small class="text-muted">{{ client.identificationType.value }}: {{ client.identificationNumber }}</small>
                        {% endif %}
                        {% if client.clientType.value == 'ORGANIZATION' and client.registrationNumber %}
                            <br>
                            <small class="text-muted">Reg: {{ client.registrationNumber }}</small>
                        {% endif %}
                    </td>
                    <td>
                            <span class="badge bg-{{ client.clientType.value == 'INDIVIDUAL' ? 'primary' : 'info' }}">
                                {{ client.clientType.value }}
                            </span>
                    </td>
                    <td>
                            <span class="badge bg-success">
                                {{ matterClient.clientRole.value|replace({'_': ' '})|title }}
                            </span>
                    </td>
                    <td>
                        {% if client.email %}
                            <i class="fas fa-envelope text-muted me-1"></i>
                            <a href="mailto:{{ client.email }}">{{ client.email }}</a>
                            <br>
                        {% endif %}
                        {% if client.primaryPhone %}
                            <i class="fas fa-phone text-muted me-1"></i>
                            {{ client.primaryPhone }}
                        {% endif %}
                    </td>
                    <td>
                        <a href="{{ ea_url()
                            .setController(client.clientType.value == 'INDIVIDUAL'
                            ? 'App\\Controller\\Admin\\ClientIndividualCrudController'
                            : 'App\\Controller\\Admin\\ClientOrganizationCrudController')
                            .setAction('detail')
                            .setEntityId(client.id) }}"
                           class="btn btn-sm btn-primary"
                           title="View Client">
                            <i class="fas fa-eye"></i>
                        </a>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
{% endif %}

{#<div class="table-responsive">#}
{#    <table class="table table-hover table-sm">#}
{#        <thead>#}
{#            <tr>#}
{#                <th>Client Name</th>#}
{#                <th>Type</th>#}
{#                <th>Role</th>#}
{#                <th>Contact</th>#}
{#                <th>Linked</th>#}
{#            </tr>#}
{#        </thead>#}
{#        <tbody>#}
{#            {% if field.value is not empty %}#}
{#                {% for matterClient in field.value %}#}
{#                    <tr>#}
{#                        <td>#}
{#                            <strong>{{ matterClient.client }}</strong>#}
{#                        </td>#}
{#                        <td>#}
{#                            {% if matterClient.client.clientType.value == 'OMANG' %}#}
{#                                <span class="badge badge-primary">Individual</span>#}
{#                            {% else %}#}
{#                                <span class="badge badge-info">Organization</span>#}
{#                            {% endif %}#}
{#                        </td>#}
{#                        <td>#}
{#                            {% if matterClient.clientRole %}#}
{#                                <span class="badge badge-secondary">{{ matterClient.clientRole.value }}</span>#}
{#                            {% else %}#}
{#                                <span class="text-muted">-</span>#}
{#                            {% endif %}#}
{#                        </td>#}
{#                        <td>#}
{#                            {% if matterClient.client.email %}#}
{#                                <div><i class="fa fa-envelope"></i> {{ matterClient.client.email }}</div>#}
{#                            {% endif %}#}
{#                            {% if matterClient.client.primaryPhone %}#}
{#                                <div><i class="fa fa-phone"></i> {{ matterClient.client.primaryPhone }}</div>#}
{#                            {% endif %}#}
{#                        </td>#}
{#                        <td>{{ matterClient.linkedAt|date('Y-m-d') }}</td>#}
{#                    </tr>#}
{#                {% endfor %}#}
{#            {% else %}#}
{#                <tr>#}
{#                    <td colspan="5" class="text-center text-muted">No clients linked to this matter</td>#}
{#                </tr>#}
{#            {% endif %}#}
{#        </tbody>#}
{#    </table>#}
{#</div>#}
